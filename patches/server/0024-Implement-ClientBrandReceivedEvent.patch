From 825434b8151c24bde862789b6171e38a4f2f31c3 Mon Sep 17 00:00:00 2001
From: willies952002 <admin@domnian.com>
Date: Sun, 24 Jul 2016 23:01:47 -0400
Subject: [PATCH] Implement ClientBrandReceivedEvent

---
 src/main/java/com/domnian/paperdragon/DragonConfig.java  | 5 +++++
 src/main/java/net/minecraft/server/PlayerConnection.java | 7 +++++++
 2 files changed, 12 insertions(+)

diff --git a/src/main/java/com/domnian/paperdragon/DragonConfig.java b/src/main/java/com/domnian/paperdragon/DragonConfig.java
index 911582e..ac85a44 100644
--- a/src/main/java/com/domnian/paperdragon/DragonConfig.java
+++ b/src/main/java/com/domnian/paperdragon/DragonConfig.java
@@ -161,4 +161,9 @@ public class DragonConfig {
         snooperEnabled = getBoolean("enable-snooper", false);
     }
 
+    public static boolean clientBrandEvent = false;
+    private static void events() {
+        clientBrandEvent = getBoolean("events.client-brand", false);
+    }
+
 }
diff --git a/src/main/java/net/minecraft/server/PlayerConnection.java b/src/main/java/net/minecraft/server/PlayerConnection.java
index 4fd7eda..45b311e 100644
--- a/src/main/java/net/minecraft/server/PlayerConnection.java
+++ b/src/main/java/net/minecraft/server/PlayerConnection.java
@@ -2215,6 +2215,13 @@ public class PlayerConnection implements PacketListenerPlayIn, ITickable {
         ItemStack itemstack;
         ItemStack itemstack1;
 
+        // PaperDragon start - Detect Client Brand & Fire Event
+        if("MC|Brand".equals(s) && com.domnian.paperdragon.DragonConfig.clientBrandEvent) {
+            packetdataserializer = packetplayincustompayload.b();
+            String brand = new String(packetdataserializer.a());
+            new com.domnian.paperdragon.event.ClientBrandReceivedEvent(this.player.getBukkitEntity(), brand);
+        } else
+        // PaperDragon end
         if ("MC|BEdit".equals(s)) {
             packetdataserializer = packetplayincustompayload.b();
 
-- 
2.5.0

