From 01cd83f4baf493af8f64af685349c30780b9f568 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Sat, 28 Dec 2013 21:17:45 -0500
Subject: [PATCH] Block EnderPearl Travel exploit

---
 src/main/java/com/domnian/paperdragon/DragonConfig.java  | 5 ++++-
 src/main/java/net/minecraft/server/EntityProjectile.java | 1 +
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/main/java/com/domnian/paperdragon/DragonConfig.java b/src/main/java/com/domnian/paperdragon/DragonConfig.java
index 6ef5dd625..06aa83606 100644
--- a/src/main/java/com/domnian/paperdragon/DragonConfig.java
+++ b/src/main/java/com/domnian/paperdragon/DragonConfig.java
@@ -156,6 +156,9 @@ public class DragonConfig {
         return config.getString(path, config.getString(path));
     }
 
-    // TODO Add New Settings!! :D
+    public static boolean blockEnderpearlTravelExploit = false;
+    private static void expoits() {
+        blockEnderpearlTravelExploit = getBoolean("settings.block-enderpearl-travel-exploit", blockEnderpearlTravelExploit);
+    }
 
 }
diff --git a/src/main/java/net/minecraft/server/EntityProjectile.java b/src/main/java/net/minecraft/server/EntityProjectile.java
index 01c7fcc8b..b760b799a 100644
--- a/src/main/java/net/minecraft/server/EntityProjectile.java
+++ b/src/main/java/net/minecraft/server/EntityProjectile.java
@@ -267,6 +267,7 @@ public abstract class EntityProjectile extends Entity implements IProjectile {
         this.shake = nbttagcompound.getByte("shake") & 255;
         this.inGround = nbttagcompound.getByte("inGround") == 1;
         this.shooter = null;
+        if (this instanceof EntityEnderPearl && com.domnian.paperdragon.DragonConfig.blockEnderpearlTravelExploit) return; // PaperDragon - Chunk reloads should not keep owner
         this.shooterName = nbttagcompound.getString("ownerName");
         if (this.shooterName != null && this.shooterName.isEmpty()) {
             this.shooterName = null;
-- 
2.15.1

