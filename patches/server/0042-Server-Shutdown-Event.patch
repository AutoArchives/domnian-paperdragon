From a6c3b409fb1dc7090aa6f5c03fad7ad00393b45f Mon Sep 17 00:00:00 2001
From: willies952002 <admin@domnian.com>
Date: Sat, 14 Apr 2018 03:26:45 -0400
Subject: [PATCH] Server Shutdown Event

---
 src/main/java/com/domnian/paperdragon/PDEventFactory.java | 5 +++++
 src/main/java/net/minecraft/server/MinecraftServer.java   | 1 +
 2 files changed, 6 insertions(+)

diff --git a/src/main/java/com/domnian/paperdragon/PDEventFactory.java b/src/main/java/com/domnian/paperdragon/PDEventFactory.java
index ee6012e49..22d37474a 100644
--- a/src/main/java/com/domnian/paperdragon/PDEventFactory.java
+++ b/src/main/java/com/domnian/paperdragon/PDEventFactory.java
@@ -1,6 +1,7 @@
 package com.domnian.paperdragon;
 
 import com.domnian.paperdragon.events.PlayerHitPlayerEvent;
+import com.domnian.paperdragon.events.ServerShutdownEvent;
 import net.minecraft.server.Entity;
 import net.minecraft.server.EntityPlayer;
 import org.bukkit.craftbukkit.entity.CraftPlayer;
@@ -18,4 +19,8 @@ public class PDEventFactory {
         }
     }
 
+    public static void handleShutdown(boolean isRestarting) {
+        new ServerShutdownEvent(isRestarting).callEvent();
+    }
+
 }
diff --git a/src/main/java/net/minecraft/server/MinecraftServer.java b/src/main/java/net/minecraft/server/MinecraftServer.java
index babf1969a..7901043aa 100644
--- a/src/main/java/net/minecraft/server/MinecraftServer.java
+++ b/src/main/java/net/minecraft/server/MinecraftServer.java
@@ -723,6 +723,7 @@ public abstract class MinecraftServer implements IAsyncTaskHandler, IMojangStati
     }
 
     public void safeShutdown(boolean isRestarting) {
+        com.domnian.paperdragon.PDEventFactory.handleShutdown(isRestarting); // PaperDragon
         this.isRunning = false;
         this.isRestarting = isRestarting;
     }
-- 
2.18.0

