From 19141213c4786ec2bb442c5139335e831d22d663 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Fri, 6 Dec 2013 20:54:23 -0500
Subject: [PATCH] AchievementBroadcastEvent

Used to control who sees achievement message
---
 src/main/java/net/minecraft/server/ServerStatisticManager.java | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/ServerStatisticManager.java b/src/main/java/net/minecraft/server/ServerStatisticManager.java
index d1bee0257..09f45c68d 100644
--- a/src/main/java/net/minecraft/server/ServerStatisticManager.java
+++ b/src/main/java/net/minecraft/server/ServerStatisticManager.java
@@ -74,7 +74,15 @@ public class ServerStatisticManager extends StatisticManager {
         if (statistic.d() && j == 0 && i > 0) {
             this.g = true;
             if (this.c.ay()) {
-                this.c.getPlayerList().sendMessage(new ChatMessage("chat.type.achievement", new Object[] { entityhuman.getScoreboardDisplayName(), statistic.j()}));
+                // PaperDragon start
+                ChatMessage achv = new ChatMessage("chat.type.achievement", new Object[] { entityhuman.getScoreboardDisplayName(), statistic.j()});
+                com.domnian.paperdragon.events.AchievementBroadcastEvent event = new com.domnian.paperdragon.events.AchievementBroadcastEvent(
+                    (org.bukkit.entity.Player) entityhuman.getBukkitEntity()
+                );
+                event.callEvent();
+                event.getReceivers().forEach(r -> ((org.bukkit.craftbukkit.entity.CraftPlayer) r).getHandle().sendMessage(achv));
+                //this.c.getPlayerList().sendMessage(new ChatMessage("chat.type.achievement", new Object[] { entityhuman.getScoreboardDisplayName(), statistic.j()}));
+                // PaperDragon end
             }
         }
 
-- 
2.11.0

